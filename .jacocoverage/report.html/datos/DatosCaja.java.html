<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="es"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>DatosCaja.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JaCoCoverage analysis of project &quot;DeliveryApp&quot; (powered by JaCoCo from EclEmma)</a> &gt; <a href="index.source.html" class="el_package">datos</a> &gt; <span class="el_source">DatosCaja.java</span></div><h1>DatosCaja.java</h1><pre class="source lang-java linenums">
package datos;

import conexion.Conectar;
import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import principal.Principal;
import subPaneles.Monto_Final;
import subPaneles.Monto_Inicial;


<span class="fc" id="L14">public class DatosCaja {</span>
    
    public ResultSet buscarCajaAbierta() throws SQLException{
<span class="fc" id="L17">        Conectar con = new Conectar();</span>
<span class="fc" id="L18">        Connection miConexion = con.conexion();</span>
        //estado = 1 y pertenece a la sucursal
       
        int id_sucursal;
<span class="nc" id="L22">        id_sucursal = Integer.parseInt(principal.Principal.Sucursal_ID.getText());</span>
<span class="nc" id="L23">        System.out.println(&quot;id_sucursal caja:&quot;+id_sucursal);</span>
<span class="nc" id="L24">        String SQL = &quot;Select * from caja WHERE estado = 1 and id_sucursal= &quot;+id_sucursal+&quot;&quot;;</span>

<span class="nc" id="L26">        Statement miEstatement = miConexion.createStatement();</span>

<span class="nc" id="L28">        ResultSet rs = miEstatement.executeQuery(SQL);</span>

<span class="nc" id="L30">        return rs;</span>
    }
    
    public void iniciarCaja(double montoInicial) throws SQLException{
<span class="fc" id="L34">        Conectar con = new Conectar();</span>
<span class="fc" id="L35">        Connection miConexion = con.conexion();</span>
<span class="fc" id="L36">        DatosUsuario xtt= new DatosUsuario();</span>
<span class="fc" id="L37">        System.out.println(&quot;es este el nombre de abajo&quot;);//el problema esta en el label la concha de su hermana</span>
<span class="fc" id="L38">            System.out.println(Principal.nombre_loc.getText().trim());</span>
<span class="fc" id="L39">           int sucursal=xtt.buscarUsuario(Principal.nombre_loc.getText());</span>
<span class="nc" id="L40">           int sucursal2=Integer.parseInt(Monto_Inicial.Ingreso_cod_sucursal_IM.getText());</span>
<span class="nc" id="L41">           System.out.println(sucursal);</span>
    
<span class="nc" id="L43">        String SQL = &quot;INSERT INTO caja (monto_inicial, monto_final, fecha, estado,id_sucursal) VALUES (&quot;+montoInicial+&quot;, &quot;+montoInicial+&quot; , NOW(), 1,&quot;+sucursal2+&quot;)&quot;;</span>
        
<span class="nc" id="L45">        Statement insertar = miConexion.createStatement();</span>
        
<span class="nc" id="L47">        insertar.executeUpdate(SQL);</span>
<span class="nc" id="L48">        System.out.println(&quot;llego a iniciar caja&quot;);</span>
<span class="nc" id="L49">    }</span>
    
    public void cerrarCaja() throws SQLException{
<span class="fc" id="L52">        Conectar con = new Conectar();</span>
<span class="fc" id="L53">        Connection miConexion = con.conexion();</span>
        
<span class="fc" id="L55">        String SQL = &quot;UPDATE caja SET estado = 0 WHERE estado = 1&quot;;</span>
        
<span class="fc" id="L57">        Statement modificar = miConexion.createStatement();</span>

<span class="fc" id="L59">        modificar.executeUpdate(SQL);</span>
        
<span class="fc" id="L61">    }</span>
    
    public void actualizarMontoTotal(double monto) throws SQLException{
<span class="fc" id="L64">        Conectar con = new Conectar();</span>
<span class="fc" id="L65">        Connection miConexion = con.conexion();</span>
        
<span class="fc" id="L67">        String SQL = &quot;UPDATE caja SET monto_final = &quot;+monto+&quot; WHERE estado = 1&quot;;</span>
        
<span class="fc" id="L69">        Statement modificar = miConexion.createStatement();</span>

<span class="fc" id="L71">        modificar.executeUpdate(SQL);</span>
<span class="fc" id="L72">    }</span>
    
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.6.201602180812</span></div></body></html>